# Check for secrets before committing
gitleaks protect --staged --verbose

# Run unit tests only (fast, no servers)
# Use `npm test` for full suite including integration tests
npm run test:unit

# KDD Topology Validation (Lisa's validation)
# Only runs if KDD documents were changed in this commit
if git diff --cached --name-only | grep -q "^docs/kdd/"; then
  echo ""
  echo "ğŸ” Lisa: Validating KDD topology (changed KDD docs detected)..."
  npm run validate-kdd

  if [ $? -ne 0 ]; then
    echo ""
    echo "âŒ Commit blocked: Fix broken KDD links before committing"
    echo "ğŸ’¡ Run 'npm run validate-kdd' to see detailed report"
    exit 1
  fi
fi
