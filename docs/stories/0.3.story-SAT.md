# Story 0.3 - Acceptance Test Guide

## Quick Summary

**Story**: Create Lisa (Librarian) Agent for KDD Documentation Curation
**Status**: Review
**Test Focus**: Verify Lisa (Librarian) agent infrastructure is complete, BMAD agents can be activated, tasks execute correctly, templates render properly, and AppyDave workflow includes Step 7

## Prerequisites

**Before testing, ensure:**

- [ ] Story 0.3 status is "Review"
- [ ] All 16 files created and 2 files updated (check story File List)
- [ ] BMAD v4.44.3 installed for Claude Code
- [ ] Working directory: `/Users/davidcruwys/dev/ad/poem-os/poem`

**Environment Setup:**

- BMAD Version: v4.44.3
- IDE: claude-code
- Working directory: `/Users/davidcruwys/dev/ad/poem-os/poem`

---

## üßë Human Tests (Visual/Manual)

Tests requiring human observation - agent activation, file content review, workflow verification.

### Test 1: AC1 - Agent definition created

**What to test**: Agent definition file `.bmad-core/agents/librarian.md` exists and contains Lisa's persona, commands, and dependencies

**Steps**:

1. Open file: `.bmad-core/agents/librarian.md`
2. Observe YAML structure
3. Check for required sections: `agent`, `persona`, `commands`, `dependencies`
4. Verify Lisa's name, title, and icon (üìö)
5. Verify 11 commands listed (help, curate, validate-topology, search-similar, consolidate, regenerate-indexes, detect-recurrence, health-dashboard, suggest-structure, epic-curation, exit)

**Expected Result**:
‚úÖ Agent definition file exists with complete structure:

- `agent.name: Lisa`
- `agent.id: librarian`
- `agent.title: Librarian`
- `agent.icon: üìö`
- All 11 commands present in `commands` section
- `dependencies` section lists tasks, templates, checklists, data

**Evidence**:

- File exists at `.bmad-core/agents/librarian.md`
- YAML parses correctly
- All required sections present

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 2: AC2 - CLI wrapper created

**What to test**: CLI wrapper file `.claude/commands/BMad/agents/librarian.md` exists and matches agent definition structure

**Steps**:

1. Open file: `.claude/commands/BMad/agents/librarian.md`
2. Compare structure with `.bmad-core/agents/librarian.md`
3. Verify both files have identical YAML content
4. Verify file follows BMAD agent CLI wrapper pattern

**Expected Result**:
‚úÖ CLI wrapper exists and matches agent definition:

- File structure identical to agent definition
- YAML content matches
- Follows BMAD CLI wrapper pattern (same as `/BMad/agents/dev`, `/BMad/agents/qa`)

**Evidence**:

- File exists at `.claude/commands/BMad/agents/librarian.md`
- Content matches agent definition

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 3: AC3 - Knowledge extraction task created

**What to test**: Task file `.bmad-core/tasks/extract-knowledge-from-story.md` exists with 8-step extraction workflow

**Steps**:

1. Open file: `.bmad-core/tasks/extract-knowledge-from-story.md`
2. Count workflow steps (should be 8)
3. Verify sections: Purpose, Inputs, Prerequisites, Process (8 steps), Output, Success Criteria
4. Check for instructions on extracting learnings, patterns, anti-patterns
5. Verify references to templates (pattern-tmpl, learning-tmpl, decision-adr-tmpl, example-tmpl)

**Expected Result**:
‚úÖ Task file contains 8-step knowledge extraction workflow:

- Step 1: Load story file and QA results
- Step 2: Extract learnings from Dev Agent Record
- Step 3: Extract patterns from implementation
- Step 4: Identify anti-patterns or lessons learned
- Step 5: Create/update KDD documentation using templates
- Step 6: Maintain topology (update indexes, cross-links)
- Step 7: Update story with knowledge asset links
- Step 8: Validate created documentation

**Evidence**:

- File exists with 8 numbered steps
- References to 4 KDD templates
- Topology maintenance instructions

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 4: AC4 - Topology validation task created

**What to test**: Task file `.bmad-core/tasks/validate-kdd-topology.md` exists with link validation and structure checks

**Steps**:

1. Open file: `.bmad-core/tasks/validate-kdd-topology.md`
2. Verify sections: Purpose, Inputs, Process, Output
3. Check for validation steps:
   - Check for broken links (VAL-001)
   - Validate directory structure (VAL-003)
   - Check for orphaned documents
   - Verify index.md files exist

**Expected Result**:
‚úÖ Task file contains topology validation workflow:

- Link health validation (30%+ broken links in SupportSignal baseline)
- Directory structure checks (detect flat directories >20 files)
- Orphan detection
- Index verification
- References VAL-001 and VAL-003 validation rules

**Evidence**:

- File exists at `.bmad-core/tasks/validate-kdd-topology.md`
- All 4 validation checks present
- References validation-rules.yaml

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 5: AC5 - Index generation task created

**What to test**: Task file `.bmad-core/tasks/generate-indexes.md` exists with auto-generate index.md instructions

**Steps**:

1. Open file: `.bmad-core/tasks/generate-indexes.md`
2. Verify Purpose describes eliminating manual TOC maintenance
3. Check for instructions to:
   - Read document frontmatter
   - Generate index.md from metadata
   - Support multi-level directory structures
4. Verify references to index file locations (docs/kdd/patterns/index.md, etc.)

**Expected Result**:
‚úÖ Task file contains index generation workflow:

- Auto-generate index.md from frontmatter
- Multi-level directory support
- Eliminates 13+ manual TOC updates per 3 months (SupportSignal baseline)
- Instructions for updating existing indexes

**Evidence**:

- File exists at `.bmad-core/tasks/generate-indexes.md`
- Frontmatter parsing instructions
- Index.md generation logic

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 6: AC6 - Semantic duplicate detection task created

**What to test**: Task file `.bmad-core/tasks/detect-semantic-duplicates.md` exists with keyword-based similarity detection

**Steps**:

1. Open file: `.bmad-core/tasks/detect-semantic-duplicates.md`
2. Verify algorithm description (keyword-based, Jaccard similarity)
3. Check for 70% similarity threshold (VAL-002)
4. Verify advisory warnings (no auto-merge)
5. Check for human-in-loop consolidation requirements

**Expected Result**:
‚úÖ Task file contains duplicate detection workflow:

- Keyword-based similarity (no RAG/embeddings)
- 70% threshold triggers warnings
- Advisory warnings only (no blocking errors)
- Human approval required for consolidation
- References VAL-002 validation rule

**Evidence**:

- File exists at `.bmad-core/tasks/detect-semantic-duplicates.md`
- Keyword-based algorithm (not AI embeddings)
- Human approval workflow

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 7: AC7 - Recurrence detection task created

**What to test**: Task file `.bmad-core/tasks/detect-recurring-issues.md` exists with recurrence pattern detection

**Steps**:

1. Open file: `.bmad-core/tasks/detect-recurring-issues.md`
2. Verify 60% signature match threshold (VAL-006)
3. Check for pattern promotion criteria (3+ recurrences)
4. Verify signature components (error keywords, components, tech stack, triggering conditions)
5. Check for advisory recommendations (no forced promotion)

**Expected Result**:
‚úÖ Task file contains recurrence detection workflow:

- 60% signature match threshold
- Pattern promotion for 3+ occurrences
- Signature components defined
- Advisory recommendations only
- References VAL-006 validation rule

**Evidence**:

- File exists at `.bmad-core/tasks/detect-recurring-issues.md`
- 3+ recurrence threshold documented
- Signature matching algorithm

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 8: AC8 - Pattern template created

**What to test**: Template file `.bmad-core/templates/pattern-tmpl.md` exists with correct sections

**Steps**:

1. Open file: `.bmad-core/templates/pattern-tmpl.md`
2. Verify required sections:
   - Context
   - Implementation
   - Examples
   - Rationale
   - Related Patterns
3. Check for frontmatter metadata (domain, topic, status, created, story_reference, pattern_type)
4. Verify filename format documentation: `{domain}-{topic}-pattern.md`

**Expected Result**:
‚úÖ Template file contains pattern document structure:

- All 5 required sections present
- Frontmatter with metadata fields
- Location: `docs/kdd/patterns/`
- Filename format: `{domain}-{topic}-pattern.md`
- Example: `password-validation-pattern.md`

**Evidence**:

- File exists at `.bmad-core/templates/pattern-tmpl.md`
- All required sections present
- Frontmatter metadata complete

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 9: AC9 - Learning template created

**What to test**: Template file `.bmad-core/templates/learning-tmpl.md` exists with correct sections

**Steps**:

1. Open file: `.bmad-core/templates/learning-tmpl.md`
2. Verify required sections:
   - Problem Signature
   - Root Cause
   - Solution
   - Prevention
   - Related Incidents
3. Check for frontmatter metadata (topic, issue, created, story_reference, category, severity, status, recurrence_count)
4. Verify filename format: `{topic}-{issue}-kdd.md`

**Expected Result**:
‚úÖ Template file contains learning document structure:

- All 5 required sections present
- Frontmatter with metadata fields
- Location: `docs/kdd/learnings/` (with subdirectories)
- Filename format: `{topic}-{issue}-kdd.md`
- Example: `cors-issue-kdd.md`

**Evidence**:

- File exists at `.bmad-core/templates/learning-tmpl.md`
- All required sections present
- Recurrence tracking metadata

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 10: AC10 - Decision/ADR template created

**What to test**: Template file `.bmad-core/templates/decision-adr-tmpl.md` exists with ADR format

**Steps**:

1. Open file: `.bmad-core/templates/decision-adr-tmpl.md`
2. Verify required sections:
   - Status
   - Context
   - Decision
   - Alternatives
   - Rationale
   - Consequences
3. Check for frontmatter metadata (adr_number, title, status, created, decision_date)
4. Verify filename format: `adr-{NNN}-{decision-name}.md`

**Expected Result**:
‚úÖ Template file contains ADR structure:

- All 6 required sections present
- Sequential numbering format (adr-001, adr-002, etc.)
- Location: `docs/kdd/decisions/`
- Filename format: `adr-{NNN}-{decision-name}.md`
- Example: `adr-001-use-jwt-authentication.md`

**Evidence**:

- File exists at `.bmad-core/templates/decision-adr-tmpl.md`
- ADR format follows best practices
- Sequential numbering documented

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 11: AC11 - Example template created

**What to test**: Template file `.bmad-core/templates/example-tmpl.md` exists with correct sections

**Steps**:

1. Open file: `.bmad-core/templates/example-tmpl.md`
2. Verify required sections:
   - Purpose
   - Setup
   - Implementation
   - Related Patterns
3. Check for frontmatter metadata (title, purpose, category, created, difficulty)
4. Verify filename format documentation

**Expected Result**:
‚úÖ Template file contains example document structure:

- All 4 required sections present
- Frontmatter with metadata fields
- Location: `docs/examples/`
- Support for single file or subdirectory structure
- Example: `auth-flow-example.md`

**Evidence**:

- File exists at `.bmad-core/templates/example-tmpl.md`
- All required sections present
- Supports both simple and complex examples

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 12: AC12 - Health report template created

**What to test**: Template file `.bmad-core/templates/health-report-tmpl.md` exists with KDD metrics dashboard

**Steps**:

1. Open file: `.bmad-core/templates/health-report-tmpl.md`
2. Verify metrics sections:
   - Link health score (VAL-001)
   - Duplication rate (VAL-002)
   - Directory structure health (VAL-003)
   - Story file size compliance (VAL-004)
   - Metadata completeness (VAL-005)
   - Recurrence detection rate (VAL-006)
3. Check for evidence-based targets from SupportSignal baseline

**Expected Result**:
‚úÖ Template file contains health report structure:

- All 6 validation rule metrics
- Target vs baseline comparison
- Evidence from SupportSignal analysis
- Dashboard format for monitoring
- Recommendations section

**Evidence**:

- File exists at `.bmad-core/templates/health-report-tmpl.md`
- All 6 validation rules covered
- Baseline metrics documented

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 13: AC13 - Knowledge curation checklist created

**What to test**: Checklist file `.bmad-core/checklists/knowledge-curation-checklist.md` exists with validation steps

**Steps**:

1. Open file: `.bmad-core/checklists/knowledge-curation-checklist.md`
2. Count checklist sections (should be 8)
3. Verify sections:
   - Documentation extracted from story
   - Assets created (patterns, learnings, decisions, examples)
   - Templates used correctly
   - Links validated
   - Indexes updated
   - Story updated with knowledge asset links
   - Topology health checked
   - Workflow completion

**Expected Result**:
‚úÖ Checklist file contains 8-section validation:

- Each section has checkboxes
- Maps to Lisa's knowledge curation workflow steps
- References validation rules (VAL-001 through VAL-006)
- Includes success criteria for each section

**Evidence**:

- File exists at `.bmad-core/checklists/knowledge-curation-checklist.md`
- All 8 sections present
- Follows BMAD checklist format

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 14: AC14 - KDD taxonomy data file created

**What to test**: Data file `.bmad-core/data/kdd-taxonomy.yaml` exists with document type definitions

**Steps**:

1. Open file: `.bmad-core/data/kdd-taxonomy.yaml`
2. Verify 4 document types defined: pattern, learning, decision, example
3. For each type, check:
   - Location (e.g., `docs/kdd/patterns/`)
   - Filename format
   - Required metadata fields
   - Required sections
   - Promotion criteria (for learnings ‚Üí patterns)
4. Verify subdirectory rules (trigger thresholds)

**Expected Result**:
‚úÖ Data file contains complete KDD taxonomy:

- 4 document types fully defined
- Required metadata for each type
- Required sections for each type
- Filename formats documented
- Pattern promotion criteria (3+ uses)
- Subdirectory organization rules
- Cross-referencing rules

**Evidence**:

- File exists at `.bmad-core/data/kdd-taxonomy.yaml`
- All 4 document types complete
- Promotion criteria evidence-based

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 15: AC15 - Validation rules data file created

**What to test**: Data file `.bmad-core/data/validation-rules.yaml` exists with VAL-001 through VAL-006

**Steps**:

1. Open file: `.bmad-core/data/validation-rules.yaml`
2. Count validation rules (should be 6: VAL-001 through VAL-006)
3. For each rule, verify:
   - ID, name, description
   - Trigger, severity, threshold
   - Evidence from SupportSignal baseline
   - Thresholds (healthy/warning/critical)
   - Remediation actions
   - Graceful degradation settings
4. Verify global settings section (graceful degradation, advisory mode, human-in-loop)

**Expected Result**:
‚úÖ Data file contains all 6 validation rules:

- VAL-001: Link Health (0 broken links target)
- VAL-002: Semantic Similarity (70% threshold)
- VAL-003: Directory Limit (20 files)
- VAL-004: Story File Size (300 lines)
- VAL-005: Metadata Completeness
- VAL-006: Recurrence Detection (60% signature match)
- All rules have evidence, thresholds, remediation
- Graceful degradation enabled globally

**Evidence**:

- File exists at `.bmad-core/data/validation-rules.yaml`
- All 6 rules complete with evidence
- Global settings configured

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 16: AC16 - AppyDave workflow integration updated

**What to test**: File `.bmad-core/tasks/execute-appydave-workflow.md` updated with Step 7 (Lisa curation)

**Steps**:

1. Open file: `.bmad-core/tasks/execute-appydave-workflow.md`
2. Locate "Step 7: Knowledge Curation (Librarian Agent)" section
3. Verify step appears after Step 6 (QA Review)
4. Check for Lisa's actions:
   - Execute `extract-knowledge-from-story.md` task
   - Analyze Dev/SAT/QA results sections
   - Create KDD documentation
   - Maintain topology
   - Update story with knowledge asset links
5. Verify workflow handoff chain includes: Quinn (QA) ‚Üí Lisa (Librarian) ‚Üí [END]

**Expected Result**:
‚úÖ AppyDave workflow includes Step 7:

- Step 7 section exists after Step 6
- Lisa's pre-check (verify Status = "Done")
- Lisa's 7 actions documented
- Halt point message displayed
- Workflow handoff chain updated
- Lisa is FINAL agent in workflow

**Evidence**:

- Step 7 section present
- Workflow ends after Lisa (no Step 8)
- Handoff chain includes Lisa

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 17: AC17 - CLAUDE.md documentation updated

**What to test**: File `CLAUDE.md` updated with Lisa usage instructions

**Steps**:

1. Open file: `/Users/davidcruwys/dev/ad/poem-os/poem/CLAUDE.md`
2. Search for "Lisa" or "Librarian" sections
3. Verify Lisa added to agent list
4. Check for:
   - Lisa's Step 7 role
   - `/BMad/agents/librarian` command
   - Lisa's 10 commands documented
   - How other agents use Lisa's docs (Quinn validates, Sarah references, James self-checks)
   - KDD document types (pattern, learning, decision, example)
   - Validation rules (VAL-001 through VAL-006)
   - Success metrics

**Expected Result**:
‚úÖ CLAUDE.md contains comprehensive Lisa documentation:

- Lisa in BMAD agent list
- Step 7 workflow integration explained
- All 10 Lisa commands documented
- KDD taxonomy explained
- Validation rules summarized
- Success metrics from SupportSignal baseline
- Examples of Lisa's output

**Evidence**:

- Lisa section exists in CLAUDE.md
- Commands documented
- Integration with other agents explained

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 18: AC18 - KDD workflow guide created

**What to test**: Guide file `docs/guides/kdd-workflow-guide.md` exists with comprehensive workflow documentation

**Steps**:

1. Open file: `docs/guides/kdd-workflow-guide.md`
2. Count sections (should be 10):
   - Problem KDD solves
   - Document taxonomy
   - Complete workflow
   - Agent usage
   - Topology maintenance
   - Validation rules
   - Success metrics
   - Best practices
   - Examples
   - Troubleshooting
3. Verify examples of Lisa's output (pattern, learning, decision, example docs)
4. Check for evidence from SupportSignal analysis

**Expected Result**:
‚úÖ Guide file contains complete KDD workflow documentation:

- All 10 sections present
- Document taxonomy explained with examples
- Lisa's commands documented
- Topology maintenance best practices
- Validation rules (VAL-001 through VAL-006) explained
- Success metrics with baseline/target
- Examples of each document type
- Troubleshooting common issues

**Evidence**:

- File exists at `docs/guides/kdd-workflow-guide.md`
- All 10 sections complete
- Examples provided

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

## ü§ñ Terminal Tests (Scriptable)

Tests using command-line tools - copy-paste ready commands.

### Test A: AC1 & AC2 - Agent files exist

**What to test**: Verify agent definition and CLI wrapper files exist

**Command**:

```bash
ls -l .bmad-core/agents/librarian.md .claude/commands/BMad/agents/librarian.md
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  [size]  [date]  .bmad-core/agents/librarian.md
-rw-r--r--  1 user  staff  [size]  [date]  .claude/commands/BMad/agents/librarian.md
```

**Validation**:

- ‚úÖ Both files exist
- ‚úÖ Both have read permissions
- ‚úÖ File sizes reasonable (>1KB)

**Status**: ‚úÖ Passed

**Notes**: Both agent files exist with correct sizes (7.8KB for agent definition, 7.9KB for CLI wrapper). Created on 2026-01-22 at 15:16.

---

### Test B: AC3-7 - Task files exist

**What to test**: Verify all 5 task files created

**Command**:

```bash
ls -1 .bmad-core/tasks/extract-knowledge-from-story.md \
     .bmad-core/tasks/validate-kdd-topology.md \
     .bmad-core/tasks/generate-indexes.md \
     .bmad-core/tasks/detect-semantic-duplicates.md \
     .bmad-core/tasks/detect-recurring-issues.md
```

**Expected Output**:

```
.bmad-core/tasks/detect-recurring-issues.md
.bmad-core/tasks/detect-semantic-duplicates.md
.bmad-core/tasks/extract-knowledge-from-story.md
.bmad-core/tasks/generate-indexes.md
.bmad-core/tasks/validate-kdd-topology.md
```

**Validation**:

- ‚úÖ All 5 task files exist
- ‚úÖ Files sorted alphabetically
- ‚úÖ Filenames match expected pattern

**Status**: ‚úÖ Passed

**Notes**: All 5 task files exist, alphabetically sorted as expected. Files present: detect-recurring-issues.md, detect-semantic-duplicates.md, extract-knowledge-from-story.md, generate-indexes.md, validate-kdd-topology.md.

---

### Test C: AC8-12 - Template files exist

**What to test**: Verify all 5 template files created

**Command**:

```bash
ls -1 .bmad-core/templates/pattern-tmpl.md \
     .bmad-core/templates/learning-tmpl.md \
     .bmad-core/templates/decision-adr-tmpl.md \
     .bmad-core/templates/example-tmpl.md \
     .bmad-core/templates/health-report-tmpl.md
```

**Expected Output**:

```
.bmad-core/templates/decision-adr-tmpl.md
.bmad-core/templates/example-tmpl.md
.bmad-core/templates/health-report-tmpl.md
.bmad-core/templates/learning-tmpl.md
.bmad-core/templates/pattern-tmpl.md
```

**Validation**:

- ‚úÖ All 5 template files exist
- ‚úÖ Files sorted alphabetically
- ‚úÖ Filenames follow template naming convention

**Status**: ‚úÖ Passed

**Notes**: All 5 template files exist, alphabetically sorted. Files present: decision-adr-tmpl.md, example-tmpl.md, health-report-tmpl.md, learning-tmpl.md, pattern-tmpl.md.

---

### Test D: AC13 - Checklist file exists

**What to test**: Verify knowledge curation checklist file created

**Command**:

```bash
ls -l .bmad-core/checklists/knowledge-curation-checklist.md
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  [size]  [date]  .bmad-core/checklists/knowledge-curation-checklist.md
```

**Validation**:

- ‚úÖ File exists
- ‚úÖ File has read permissions
- ‚úÖ File size reasonable (>2KB for 8 sections)

**Status**: ‚úÖ Passed

**Notes**: Checklist file exists with size 8.2KB (8 comprehensive sections). Created on 2026-01-22 at 15:24.

---

### Test E: AC14 & AC15 - Data files exist

**What to test**: Verify KDD taxonomy and validation rules data files created

**Command**:

```bash
ls -l .bmad-core/data/kdd-taxonomy.yaml .bmad-core/data/validation-rules.yaml
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  [size]  [date]  .bmad-core/data/kdd-taxonomy.yaml
-rw-r--r--  1 user  staff  [size]  [date]  .bmad-core/data/validation-rules.yaml
```

**Validation**:

- ‚úÖ Both YAML files exist
- ‚úÖ Both have read permissions
- ‚úÖ File sizes reasonable (>10KB for comprehensive data)

**Status**: ‚úÖ Passed

**Notes**: Both YAML data files exist. kdd-taxonomy.yaml: 12.6KB (created 15:25), validation-rules.yaml: 13.6KB (created 15:26). Both created on 2026-01-22.

---

### Test F: AC18 - KDD workflow guide exists

**What to test**: Verify KDD workflow guide documentation created

**Command**:

```bash
ls -l docs/guides/kdd-workflow-guide.md
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  [size]  [date]  docs/guides/kdd-workflow-guide.md
```

**Validation**:

- ‚úÖ File exists
- ‚úÖ File has read permissions
- ‚úÖ File size substantial (>20KB for comprehensive guide)

**Status**: ‚úÖ Passed

**Notes**: KDD workflow guide exists with substantial size 29.3KB (comprehensive 10-section guide). Created on 2026-01-22 at 15:31.

---

### Test G: AC1 - Agent YAML structure valid

**What to test**: Verify Lisa agent definition has valid YAML structure

**Command**:

```bash
grep -E "^agent:|^persona:|^commands:|^dependencies:" .bmad-core/agents/librarian.md
```

**Expected Output**:

```
agent:
persona:
commands:
dependencies:
```

**Validation**:

- ‚úÖ All 4 required YAML sections present
- ‚úÖ Sections at root level (no indentation)
- ‚úÖ YAML structure follows BMAD pattern

**Status**: ‚úÖ Passed

**Notes**: All 4 required YAML sections present at root level: agent, persona, commands, dependencies. YAML structure follows BMAD pattern correctly.

---

### Test H: AC14 - KDD taxonomy document types count

**What to test**: Verify kdd-taxonomy.yaml defines 4 document types

**Command**:

```bash
grep "^  [a-z]*:" .bmad-core/data/kdd-taxonomy.yaml | grep -A1 "document_types:" | tail -n +2
```

**Expected Output**:

```
  pattern:
  learning:
  decision:
  example:
```

**Validation**:

- ‚úÖ 4 document types defined
- ‚úÖ Types are: pattern, learning, decision, example
- ‚úÖ YAML structure correct

**Status**: ‚úÖ Passed

**Notes**: File verified to contain 4 document types in document_types section: pattern (line 17), learning (line 66), decision (line 116), example (line 160). YAML structure correct.

---

### Test I: AC15 - Validation rules count

**What to test**: Verify validation-rules.yaml defines 6 validation rules (VAL-001 through VAL-006)

**Command**:

```bash
grep -E "^  - id: \"VAL-" .bmad-core/data/validation-rules.yaml
```

**Expected Output**:

```
  - id: "VAL-001"
  - id: "VAL-002"
  - id: "VAL-003"
  - id: "VAL-004"
  - id: "VAL-005"
  - id: "VAL-006"
```

**Validation**:

- ‚úÖ 6 validation rules defined
- ‚úÖ Sequential IDs (VAL-001 through VAL-006)
- ‚úÖ YAML structure correct

**Status**: ‚úÖ Passed

**Notes**: All 6 validation rules defined sequentially: VAL-001 (Link Health), VAL-002 (Semantic Similarity), VAL-003 (Directory Limit), VAL-004 (Story File Size), VAL-005 (Metadata Completeness), VAL-006 (Recurrence Detection). YAML structure correct.

---

### Test J: AC16 - AppyDave workflow Step 7 exists

**What to test**: Verify execute-appydave-workflow.md contains Step 7 (Lisa curation)

**Command**:

```bash
grep -A2 "^### Step 7:" .bmad-core/tasks/execute-appydave-workflow.md
```

**Expected Output**:

```
### Step 7: Knowledge Curation (Librarian Agent)

**Agent Context**: Load Librarian (Lisa) agent context and capabilities
```

**Validation**:

- ‚úÖ Step 7 section exists
- ‚úÖ Section titled "Knowledge Curation (Librarian Agent)"
- ‚úÖ References Lisa agent

**Status**: ‚úÖ Passed

**Notes**: Step 7 "Knowledge Curation (Librarian Agent)" exists in execute-appydave-workflow.md. Section properly references Lisa agent context and capabilities.

---

### Test K: AC17 - CLAUDE.md mentions Lisa

**What to test**: Verify CLAUDE.md updated with Lisa documentation

**Command**:

```bash
grep -i "lisa\|librarian" CLAUDE.md | head -5
```

**Expected Output**:

```
- **Lisa (Librarian)** - Curates Knowledge-Driven Development (KDD) documentation
/BMad/agents/librarian   # Lisa: KDD curation
## Lisa (Librarian) Agent
Lisa is the Librarian agent responsible for knowledge curation...
```

**Validation**:

- ‚úÖ CLAUDE.md mentions Lisa/Librarian
- ‚úÖ Lisa command documented
- ‚úÖ Lisa's role explained

**Status**: ‚úÖ Passed

**Notes**: CLAUDE.md updated with comprehensive Lisa documentation. References found: "Librarian (Lisa) - Documentation Curator", "/BMad/agents/librarian" command, workflow integration showing "Lisa curates knowledge", "Librarian Agent (Lisa) Integration" section. All key documentation present.

---

## ‚è≥ Not Testable Yet

**None**: All acceptance criteria are testable through file verification, content review, and command execution.

---

## Test Checklist

Copy this checklist to track overall progress:

**Human Tests:**

- [ ] Test 1: AC1 - Agent definition file structure
- [ ] Test 2: AC2 - CLI wrapper matches agent definition
- [ ] Test 3: AC3 - Knowledge extraction 8-step workflow
- [ ] Test 4: AC4 - Topology validation checks
- [ ] Test 5: AC5 - Index generation instructions
- [ ] Test 6: AC6 - Semantic duplicate detection (70% threshold)
- [ ] Test 7: AC7 - Recurrence detection (60% threshold)
- [ ] Test 8: AC8 - Pattern template structure
- [ ] Test 9: AC9 - Learning template structure
- [ ] Test 10: AC10 - ADR template structure
- [ ] Test 11: AC11 - Example template structure
- [ ] Test 12: AC12 - Health report metrics
- [ ] Test 13: AC13 - Knowledge curation checklist (8 sections)
- [ ] Test 14: AC14 - KDD taxonomy (4 document types)
- [ ] Test 15: AC15 - Validation rules (VAL-001 through VAL-006)
- [ ] Test 16: AC16 - AppyDave workflow Step 7 integration
- [ ] Test 17: AC17 - CLAUDE.md Lisa documentation
- [ ] Test 18: AC18 - KDD workflow guide (10 sections)

**Terminal Tests:**

- [x] Test A: Agent files exist ‚úÖ
- [x] Test B: Task files exist (5 files) ‚úÖ
- [x] Test C: Template files exist (5 files) ‚úÖ
- [x] Test D: Checklist file exists ‚úÖ
- [x] Test E: Data files exist (2 YAML files) ‚úÖ
- [x] Test F: KDD workflow guide exists ‚úÖ
- [x] Test G: Agent YAML structure valid ‚úÖ
- [x] Test H: KDD taxonomy document types count (4) ‚úÖ
- [x] Test I: Validation rules count (6) ‚úÖ
- [x] Test J: AppyDave workflow Step 7 exists ‚úÖ
- [x] Test K: CLAUDE.md mentions Lisa ‚úÖ

**Overall Status**: ‚úÖ All Terminal Tests Passed (11/11) | Human Tests Pending User Execution

---

## Troubleshooting

### Issue: Agent file not found

**Symptom**: `/BMad/agents/librarian` command returns "file not found"
**Solution**: Verify file exists at `.claude/commands/BMad/agents/librarian.md` - may need to restart Claude Code to reload commands

### Issue: YAML parsing error in agent file

**Symptom**: Agent file has YAML syntax errors
**Solution**: Check for:
- Proper indentation (2 spaces)
- No tabs in YAML
- All strings properly quoted if they contain special characters
- YAML block starts with triple backticks and `yaml` language identifier

### Issue: Task file missing sections

**Symptom**: Task file doesn't contain expected sections (Purpose, Inputs, Process)
**Solution**: Compare with existing BMAD task files (e.g., `.bmad-core/tasks/create-next-story.md`) to ensure structure matches pattern

### Issue: Template file missing frontmatter

**Symptom**: Template file doesn't have YAML frontmatter
**Solution**: Ensure template starts with `---`, contains metadata fields, and ends with `---` before markdown content

### Issue: Validation rules YAML malformed

**Symptom**: validation-rules.yaml has YAML parsing errors
**Solution**: Validate YAML structure using yamllint or online YAML validator - check for:
- Proper list syntax (`- id: "VAL-001"`)
- Nested structure indentation
- String quoting consistency

### Issue: AppyDave workflow update not visible

**Symptom**: Step 7 not appearing in execute-appydave-workflow.md
**Solution**: Ensure Step 7 section added after Step 6, before any footer/notes sections - check workflow handoff chain updated to include Lisa

---

## Test Results Summary

**Date Tested**: 2026-01-22
**Tester**: Taylor (SAT Agent)

**Automated Test Results**:

- Human Tests: 0 / 18 passed (pending manual execution)
- Terminal Tests: 11 / 11 passed ‚úÖ
- Total Automated: 11 / 11 passed (100%)

**Issues Found**:

None in automated tests. All 11 terminal tests passed successfully.

**Sign-off**: ‚è≥ Awaiting human test execution | Terminal tests ‚úÖ passed

---

_Generated by Taylor (SAT Guide Creator) from Story 0.3_
