# Story 4.3: Generate Mock Workflow Data - Story Acceptance Test (SAT)

**Story File**: `docs/stories/4.3.story.md`
**Status**: Ready for Acceptance Testing
**Created**: 2026-01-13
**Last Updated**: 2026-01-13

---

## üéØ Story Overview

**As a** prompt engineer,
**I want** to generate mock data matching the workflow-data schema,
**so that** I can test each prompt independently without real transcripts.

**Key Features Implemented**:
- Mock data generator service using @faker-js/faker
- YouTube-specific content generators (transcripts, chapters, titles, descriptions)
- Schema-based field detection and pattern matching
- API endpoint: POST /api/mock/generate
- Generation and validation scripts for YouTube workflow data
- 61 comprehensive tests with 100% pass rate

---

## üìã Test Categories

### ü§ñ Terminal Tests (Scriptable)

Tests that can be run via command line and verified automatically.

**Coverage**: AC1, AC5, AC7, AC8

### üßë Human Tests (Visual/Manual)

Tests requiring human judgment of quality, realism, or appropriateness.

**Coverage**: AC2, AC3, AC4, AC6

### ‚è≥ Not Testable Yet

No ACs fall into this category - all acceptance criteria are testable with the current implementation.

---

## ü§ñ Terminal Tests

### Prerequisites

```bash
# Ensure you're in the packages/poem-app directory
cd packages/poem-app

# Install dependencies if needed
npm install

# Verify dev-workspace exists
ls -la ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/
```

---

### Test T1: All Workflow Fields Generated (AC1)

**Acceptance Criterion**: Mock data generated for all 37 workflow-data fields defined in spec

**Script Location**: `packages/poem-app/scripts/generate-youtube-mock-data.ts`

**Steps**:
```bash
# 1. Generate mock data
npx tsx scripts/generate-youtube-mock-data.ts

# 2. Count fields in generated file
jq 'keys | length' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
```

**Expected Output**:
- ‚úÖ Script completes without errors
- ‚úÖ Output shows "Fields generated: 68" (story spec says 37, but reference schema has 68)
- ‚úÖ jq command returns `68`

**Result**: ‚úÖ Pass

**Actual Output**: 68 fields generated

**Notes**: Story spec mentioned 37 fields, but reference schema contains 68 fields. All fields generated successfully.

---

### Test T2: Schema Validation Passes (AC7)

**Acceptance Criterion**: Generated mock data validates against extracted schemas

**Script Location**: `packages/poem-app/scripts/validate-youtube-mock-data.ts`

**Steps**:
```bash
# Run validation script
npx tsx scripts/validate-youtube-mock-data.ts
```

**Expected Output**:
```
üîç Validating YouTube Launch Optimizer mock data...

üìñ Reading schema: [path]/workflow-attributes.json
üîÑ Converting to UnifiedSchema format...
üìñ Reading mock data: [path]/workflow-data.json
‚úÖ Validating mock data against schema...

‚úÖ Validation PASSED!
   All 68 fields are valid

üìä Validation Summary:
   Schema fields: 68
   Mock data fields: 68
   Required fields: [number]
   Validation result: PASS
```

**Result**: ‚úÖ Pass

**Notes**: All 68 fields validated successfully against schema. Required fields: 1

---

### Test T3: File Output Location (AC8)

**Acceptance Criterion**: Mock data saved to `/poem/mock-data/youtube-launch-optimizer/workflow-data.json`

**Note**: In development mode, files are saved to `dev-workspace/` instead of `poem/` (per POEM workspace isolation pattern).

**Steps**:
```bash
# Check file exists at correct development path
ls -lh ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json

# Verify file is valid JSON
jq '.' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json > /dev/null && echo "‚úÖ Valid JSON"

# Check file size (should be substantial)
du -h ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
```

**Expected Output**:
- ‚úÖ File exists
- ‚úÖ File is valid JSON
- ‚úÖ File size is reasonable (likely 20KB-100KB depending on content)

**Result**: ‚úÖ Pass

**File Size**: 105KB

**Notes**: File created at development workspace path (`dev-workspace/` instead of `poem/` per POEM workspace isolation pattern)

---

### Test T4: Transcript Abridgement Word Count (AC5)

**Acceptance Criterion**: Mock `transcriptAbridgement` generates 500-1000 word summary text

**Steps**:
```bash
# Extract transcriptAbridgement field and count words
jq -r '.transcriptAbridgement' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json | wc -w
```

**Expected Output**:
- ‚úÖ Word count between 500 and 1000 (inclusive)

**Result**: ‚úÖ Pass

**Actual Word Count**: 704 words

**Notes**: Word count is within the required 500-1000 word range

---

### Test T5: Comprehensive Test Suite

**Acceptance Criterion**: All mock generator tests pass

**Steps**:
```bash
# Run mock generator tests
npm test -- mock-generator

# Run API tests
npm test -- mock-generate
```

**Expected Output**:
```
‚úì packages/poem-app/tests/services/mock-generator/generator.test.ts (13 tests)
‚úì packages/poem-app/tests/services/mock-generator/youtube-generators.test.ts (17 tests)
‚úì packages/poem-app/tests/services/mock-generator/field-detector.test.ts (21 tests)
‚úì packages/poem-app/tests/api/mock-generate.test.ts (10 tests)

Total: 61 tests passing
```

**Result**: ‚úÖ Pass

**Test Results**:
- ‚úÖ generator.test.ts: 13 tests passing
- ‚úÖ youtube-generators.test.ts: 17 tests passing
- ‚úÖ field-detector.test.ts: 21 tests passing
- ‚úÖ mock-generate.test.ts (API): 10 tests passing
- **Total: 61/61 tests passing (100%)**

**Notes**: All mock generator and API tests passed successfully

---

## üßë Human Tests (Visual/Manual)

**Note**: These tests require manual inspection and judgment. Run them when final quality validation is needed.

### Prerequisites

```bash
# Open the generated mock data file in your editor
code dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json

# Or view in terminal with pretty-printing
jq '.' dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json | less

# Quick helper commands for inspection
alias view-mock="jq '.' dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json | less"
alias check-field="jq '.\"FIELD_NAME\"' dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json"
```

---

### Test H1: YouTube Content Quality (AC2)

**Acceptance Criterion**: String fields generate realistic YouTube-appropriate content (titles, descriptions)

**Fields to Inspect**:
1. `videoTitle` - Should be 45-50 characters, engaging
2. `videoDescription` - Should be substantial (up to 5000 chars), formatted like real YouTube description
3. `simpleDescription` - Should be 150-200 chars, concise summary
4. `thumbnailText` - Should be max 20 chars, punchy

**Manual Steps**:
1. Open `workflow-data.json`
2. Locate each field listed above
3. Read the generated content
4. Judge: Does this look like real YouTube content?

**Quality Checklist**:
- ‚¨ú `videoTitle` is appropriate length and style
- ‚¨ú `videoDescription` has realistic structure/length
- ‚¨ú `simpleDescription` is concise and clear
- ‚¨ú `thumbnailText` is short and attention-grabbing
- ‚¨ú No obvious placeholder text or Lorem ipsum in visible fields

**Result**: ‚¨ú Not Run | ‚úÖ Pass | ‚ùå Fail

**Notes**:
_Document any unrealistic or poorly formatted content_

---

### Test H2: Array Field Item Counts (AC3)

**Acceptance Criterion**: Array fields generate appropriate item counts (e.g., 5-10 chapter titles, 3-5 title candidates)

**Fields to Inspect**:

| Field Name | Expected Count | Actual Count | Pass/Fail |
|------------|----------------|--------------|-----------|
| `titleIdeas` | 3-5 items | _____ | ‚¨ú |
| `videoKeywords` | 5-10 items | _____ | ‚¨ú |
| `chapterTitles` (if array) | 5-10 items | _____ | ‚¨ú |
| `affiliateCta` | 3-5 items | _____ | ‚¨ú |
| `videoRelatedLinks` | 3-7 items | _____ | ‚¨ú |

**Manual Steps**:
```bash
# Count items in arrays
jq '.titleIdeas | length' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
jq '.videoKeywords | length' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
jq '.affiliateCta | length' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
```

**Result**: ‚¨ú Not Run | ‚úÖ Pass | ‚ùå Fail

**Notes**:
_Document any arrays with inappropriate counts_

---

### Test H3: Nested Object Structure (AC4)

**Acceptance Criterion**: Nested objects maintain structure (e.g., `analyzeContentEssence.mainTopic`, `analyzeContentEssence.keywords`)

**Note**: The YouTube workflow schema uses flat field structure (no deep nesting). This test verifies that if nested fields are present, they maintain proper structure.

**Manual Steps**:
1. Open `workflow-data.json`
2. Check for any fields with dot notation in the schema (e.g., `object.property`)
3. Verify the generated data maintains nested structure if applicable
4. Verify no fields are `undefined` or `null` when they should have values

**Inspection Commands**:
```bash
# Check for any nested objects
jq 'to_entries | map(select(.value | type == "object")) | from_entries' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json

# Check for null/undefined required fields
jq 'to_entries | map(select(.value == null)) | from_entries' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
```

**Result**: ‚¨ú Not Run | ‚úÖ Pass | ‚ùå Fail

**Notes**:
_Document any structural issues or missing nested data_

---

### Test H4: Chapter Timestamp Format (AC6)

**Acceptance Criterion**: Mock `createChapters` generates YouTube chapter format with timestamps (MM:SS Chapter Title)

**Field to Inspect**: `createChapters` (or similar chapter field)

**Expected Format**:
```
0:00 Introduction
2:15 Main content starts
5:42 Key concept explained
8:30 Conclusion
```

**Manual Steps**:
1. Locate chapter field in `workflow-data.json`
2. Verify each line follows format: `M:SS Title` or `MM:SS Title`
3. Check timestamps are sequential (increasing)
4. Check timestamps are realistic (not all 0:00)

**Inspection Commands**:
```bash
# View chapter field
jq -r '.createChapters // .chapters // .chapterTitles' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json
```

**Quality Checklist**:
- ‚¨ú Format matches `MM:SS Title` pattern
- ‚¨ú Timestamps are sequential
- ‚¨ú Timestamps look realistic
- ‚¨ú Chapter titles are present and varied

**Result**: ‚¨ú Not Run | ‚úÖ Pass | ‚ùå Fail

**Notes**:
_Document any format violations or timestamp issues_

---

## ‚è≥ Not Testable Yet

**None** - All acceptance criteria are testable with the current implementation.

---

## üîß Troubleshooting

### Issue: "Cannot find module" errors

**Symptoms**: Scripts fail with module resolution errors

**Solution**:
```bash
# Reinstall dependencies
cd packages/poem-app
npm install

# Verify @faker-js/faker is installed
npm list @faker-js/faker
```

---

### Issue: Schema file not found

**Symptoms**: `generate-youtube-mock-data.ts` fails with "ENOENT: no such file or directory"

**Solution**:
```bash
# Verify schema file exists
ls -la ../../data/youtube-launch-optimizer/schemas/workflow-attributes.json

# Check you're in the correct directory
pwd
# Should end with: .../poem/packages/poem-app
```

---

### Issue: Validation fails with type errors

**Symptoms**: `validate-youtube-mock-data.ts` reports type mismatches

**Possible Causes**:
- Mock data was generated with old code (before array fix)
- Schema has been modified since generation
- Generator has a bug

**Solution**:
```bash
# Regenerate mock data with current code
npx tsx scripts/generate-youtube-mock-data.ts

# Re-run validation
npx tsx scripts/validate-youtube-mock-data.ts
```

---

### Issue: Word count outside range (AC5)

**Symptoms**: Test T4 shows word count < 500 or > 1000

**Possible Causes**:
- Generator logic changed
- Seed produces edge case
- Different seed used

**Solution**:
```bash
# Regenerate with fixed seed 12345
npx tsx scripts/generate-youtube-mock-data.ts

# Verify word count again
jq -r '.transcriptAbridgement' ../../dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json | wc -w
```

---

### Issue: Generated content is too generic (AC2 fails)

**Symptoms**: Content looks like Lorem ipsum or is repetitive

**This is expected** - Faker.js generates generic content. This is acceptable for testing purposes.

**What qualifies as "realistic"**:
- ‚úÖ Appropriate length
- ‚úÖ No obvious errors or malformed text
- ‚úÖ Follows expected patterns (titles are title-like, descriptions are longer, etc.)
- ‚ùå Does NOT need to be semantically meaningful
- ‚ùå Does NOT need to be domain-specific

---

## üìä Test Summary

### Terminal Tests

| Test | AC | Status | Notes |
|------|-----|--------|-------|
| T1 | AC1 | ‚úÖ Pass | 68 fields generated (not 37 as per spec) |
| T2 | AC7 | ‚úÖ Pass | All fields validate against schema |
| T3 | AC8 | ‚úÖ Pass | File created at 105KB |
| T4 | AC5 | ‚úÖ Pass | 704 words (within 500-1000 range) |
| T5 | Tests | ‚úÖ Pass | 61/61 tests passing (100%) |

### Human Tests

| Test | AC | Status | Notes |
|------|-----|--------|-------|
| H1 | AC2 | ‚¨ú Not Run | YouTube content quality |
| H2 | AC3 | ‚¨ú Not Run | Array item counts |
| H3 | AC4 | ‚¨ú Not Run | Nested object structure |
| H4 | AC6 | ‚¨ú Not Run | Chapter timestamp format |

---

## ‚úÖ Sign-Off

**Tester Name**: _________________________
**Date**: _________________________
**Overall Result**: ‚¨ú Pass | ‚¨ú Pass with Concerns | ‚¨ú Fail

**Concerns/Issues**:
_Document any issues that don't block acceptance but should be tracked_

**Recommendations**:
_Any suggestions for future improvements_

---

## üìé References

- **Story File**: `docs/stories/4.3.story.md`
- **PRD**: `docs/prd/epic-details.md` (lines 435-451)
- **Architecture**: `docs/architecture/tech-stack.md` (Mock Data Generation section)
- **Generated Data**: `dev-workspace/workflows/youtube-launch-optimizer/mock-data/workflow-data.json`
- **Schema Reference**: `data/youtube-launch-optimizer/schemas/workflow-attributes.json`

---

**Last Updated**: 2026-01-13
