# Story 3.1 - Acceptance Test Guide

## Quick Summary

**Story**: Create Prompt Engineer Agent Definition
**Status**: Review
**Test Focus**: Verify the Prompt Engineer agent (Penny) is properly defined following BMAD v4 pattern with correct persona, commands, and dependencies.

## Prerequisites

**Before testing, ensure:**

- [x] Story status is "Review"
- [x] All implementation files created per Dev Agent Record
- [ ] Claude Code CLI available for Human Tests

**Files to verify exist:**

- `packages/poem-core/agents/prompt-engineer.md`
- `packages/poem-core/data/poem-principles.md`
- `packages/poem-core/data/prompt-best-practices.md`
- `.claude/commands/poem/agents/penny.md`

**Working directory**: `/Users/davidcruwys/dev/ad/poem-os/poem`

---

## ğŸ¤– Terminal Tests (File Verification)

Tests verifying file structure and content - copy-paste ready commands.

### Test A: AC1 - Agent definition file exists

**What to test**: Agent definition file exists at correct location

**Command**:

```bash
ls -la packages/poem-core/agents/prompt-engineer.md
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  XXXX  Dec 30 XX:XX packages/poem-core/agents/prompt-engineer.md
```

**Validation**:

- âœ… File exists
- âœ… File is readable
- âœ… File has content (size > 0)

**Status**: âœ… Passed

**Notes**: File exists with size 5113 bytes, dated Dec 30 14:37

---

### Test B: AC2 - BMAD structure present

**What to test**: Agent follows BMAD agent structure with YAML config

**Command**:

```bash
grep -c "<!-- Powered by BMADâ„¢ Core -->" packages/poem-core/agents/prompt-engineer.md && \
grep -c "IDE-FILE-RESOLUTION:" packages/poem-core/agents/prompt-engineer.md && \
grep -c "REQUEST-RESOLUTION:" packages/poem-core/agents/prompt-engineer.md && \
grep -c "activation-instructions:" packages/poem-core/agents/prompt-engineer.md
```

**Expected Output**:

```
1
1
1
1
```

**Validation**:

- âœ… BMAD header present
- âœ… IDE-FILE-RESOLUTION section exists
- âœ… REQUEST-RESOLUTION section exists
- âœ… activation-instructions section exists

**Status**: âœ… Passed

**Notes**: All 4 BMAD structure elements found (each returned count of 1)

---

### Test C: AC3 - Persona defined correctly

**What to test**: Persona has name, role, style, core principles

**Command**:

```bash
grep -E "name: Penny|role:|style:|core_principles:" packages/poem-core/agents/prompt-engineer.md
```

**Expected Output** (should show these lines):

```
  name: Penny
  role: Expert Prompt Engineer & Template Architect
  style: Methodical, quality-focused, educational
core_principles:
```

**Validation**:

- âœ… Agent name is "Penny"
- âœ… Role is defined
- âœ… Style is defined
- âœ… Core principles section exists

**Status**: âœ… Passed

**Notes**: All persona elements verified: Penny, Expert Prompt Engineer & Template Architect, Methodical style

---

### Test D: AC4 - Commands listed

**What to test**: All required commands (*new, *refine, *test, *validate, *help) are defined

**Command**:

```bash
grep -E "^\s*- (help|new|refine|test|validate|exit):" packages/poem-core/agents/prompt-engineer.md | wc -l
```

**Expected Output**:

```
6
```

**Validation**:

- âœ… help command defined
- âœ… new command defined
- âœ… refine command defined
- âœ… test command defined
- âœ… validate command defined
- âœ… exit command defined (6 total)

**Status**: âœ… Passed

**Notes**: Grep found 6 command definitions as expected

---

### Test E: AC5 - Data files exist and referenced

**What to test**: POEM principles and best practices files exist

**Command**:

```bash
ls packages/poem-core/data/poem-principles.md packages/poem-core/data/prompt-best-practices.md 2>/dev/null && \
grep "poem-principles.md" packages/poem-core/agents/prompt-engineer.md | head -1
```

**Expected Output**:

```
packages/poem-core/data/poem-principles.md
packages/poem-core/data/prompt-best-practices.md
  - STEP 4: Load and read `.poem-core/data/poem-principles.md` for POEM knowledge base
```

**Validation**:

- âœ… poem-principles.md exists
- âœ… prompt-best-practices.md exists
- âœ… Agent activation-instructions reference data file

**Status**: âœ… Passed

**Notes**: Both data files exist, STEP 4 in activation-instructions references poem-principles.md

---

### Test F: AC6 - Slash command wrapper exists

**What to test**: Claude Code slash command file exists at correct location

**Command**:

```bash
ls -la .claude/commands/poem/agents/penny.md && \
head -5 .claude/commands/poem/agents/penny.md
```

**Expected Output**:

```
-rw-r--r--  1 user  staff  XXXX  Dec 30 XX:XX .claude/commands/poem/agents/penny.md
# /poem/agents/penny Command

When this command is used, adopt the following agent persona:

<!-- Powered by BMADâ„¢ Core -->
```

**Validation**:

- âœ… Slash command file exists
- âœ… Contains correct command header
- âœ… Contains agent persona instruction
- âœ… Contains BMAD header

**Status**: âœ… Passed

**Notes**: File exists (5267 bytes), correct header "# /poem/agents/penny Command"

---

## ğŸ§‘ Human Tests (Claude Code Conversation)

Tests requiring human interaction with Claude Code CLI.

### Test 1: AC6 - Slash command activates agent

**What to test**: `/poem/agents/penny` slash command activates the agent

**Steps**:

1. Open a new Claude Code session in the poem project directory
2. Type: `/poem/agents/penny`
3. Press Enter
4. Observe agent activation

**Expected Result**:
âœ… Agent activates successfully:

- Agent name "Penny" appears in greeting
- Agent title "Prompt Engineer" mentioned
- Agent icon âœï¸ may appear
- No error messages

**Evidence**:

- Screenshot of Claude Code showing agent activation
- Greeting message visible

**Status**: â¬œ Not Tested | âœ… Passed | âŒ Failed

**Notes**: _________________

---

### Test 2: AC7 - Agent greets and displays commands

**What to test**: After activation, agent greets user and runs *help

**Steps**:

1. After Test 1 activation completes
2. Observe the initial agent response
3. Verify *help output is displayed automatically

**Expected Result**:
âœ… Agent displays:

- Greeting with agent name (Penny) and role (Prompt Engineer)
- Numbered list of available commands:
  1. help
  2. new
  3. refine
  4. test
  5. validate
  6. exit

**Evidence**:

- Screenshot showing greeting message
- Screenshot showing numbered command list

**Status**: â¬œ Not Tested | âœ… Passed | âŒ Failed

**Notes**: _________________

---

### Test 3: AC3/AC7 - Persona consistency

**What to test**: Agent maintains persona throughout conversation

**Steps**:

1. After activation, ask: "What is your name and role?"
2. Observe response
3. Ask: "What are your core principles?"
4. Observe response

**Expected Result**:
âœ… Agent responds:

- Identifies as "Penny" the Prompt Engineer
- Describes methodical, quality-focused style
- Lists core principles related to prompt engineering
- Stays in character throughout

**Evidence**:

- Agent's response to identity question
- Agent's response about principles

**Status**: â¬œ Not Tested | âœ… Passed | âŒ Failed

**Notes**: _________________

---

### Test 4: AC4 - Commands reference workflows

**What to test**: Commands mention correct workflow files

**Steps**:

1. While agent is active, type: `*help`
2. Observe command descriptions
3. Verify workflow file references

**Expected Result**:
âœ… Help output shows:

- new â†’ references new-prompt.yaml workflow
- refine â†’ references refine-prompt.yaml workflow
- test â†’ references test-prompt.yaml workflow
- validate â†’ references validate-prompt.yaml workflow

**Evidence**:

- Screenshot of *help output showing workflow references

**Status**: â¬œ Not Tested | âœ… Passed | âŒ Failed

**Notes**: _________________

---

## â³ Not Testable Yet

**Workflow Execution**: Commands *new, *refine, *test, *validate cannot be fully executed yet.
**Reason**: Workflow files (new-prompt.yaml, etc.) will be created in Stories 3.2-3.5.
**When**: Stories 3.2-3.5 will enable full workflow testing.

---

## Test Checklist

Copy this checklist to track overall progress:

**Terminal Tests:**

- [x] Test A: Agent definition file exists âœ…
- [x] Test B: BMAD structure present âœ…
- [x] Test C: Persona defined correctly âœ…
- [x] Test D: Commands listed âœ…
- [x] Test E: Data files exist and referenced âœ…
- [x] Test F: Slash command wrapper exists âœ…

**Human Tests:**

- [ ] Test 1: Slash command activates agent
- [ ] Test 2: Agent greets and displays commands
- [ ] Test 3: Persona consistency
- [ ] Test 4: Commands reference workflows

**Overall Status**: ğŸ”„ In Progress (Terminal: 6/6 passed, Human: 0/4 pending)

---

## Troubleshooting

### Issue: Slash command not found

**Symptom**: `/poem/agents/penny` returns "command not found"
**Solution**: Ensure `.claude/commands/poem/agents/penny.md` exists and Claude Code has been restarted to pick up new commands.

### Issue: Agent doesn't load data files

**Symptom**: Agent doesn't mention POEM principles on activation
**Solution**: Verify `packages/poem-core/data/poem-principles.md` exists and is referenced in activation-instructions STEP 4.

### Issue: YAML parse error

**Symptom**: Agent fails to activate with YAML error
**Solution**: Check YAML syntax in agent file - ensure proper indentation (2 spaces), no tabs.

---

## Test Results Summary

**Date Tested**: 2025-12-30 (Terminal Tests)
**Tester**: Taylor (SAT Agent) - Terminal Tests automated

**Results**:

- Terminal Tests: 6 / 6 passed âœ…
- Human Tests: 0 / 4 pending (requires manual execution)
- Total: 6 / 10 passed (automated portion complete)

**Issues Found**:

None from Terminal Tests.

**Sign-off**: â³ Pending Human Tests | âœ… Story accepted | âŒ Issues require fixes

---

_Generated by Taylor (SAT Guide Creator) from Story 3.1_
