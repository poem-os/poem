# Story 1.3 - Acceptance Test Guide

## Quick Summary

**Story**: Create poem-app Package Structure
**Status**: Review
**Test Focus**: Verify Astro project structure, health endpoint, and Tailwind CSS integration

## Prerequisites

**Before testing, ensure:**

- [ ] Story status is "Review" or "Complete"
- [ ] No Astro dev server currently running on port 4321
- [ ] Dependencies installed (`cd packages/poem-app && npm install`)

**Environment Setup:**

- Node.js: 22.x LTS
- Default Port: 4321
- Working directory: `packages/poem-app/`

---

## üßë Human Tests (Visual/Manual)

Tests requiring human observation - browser, terminal colors, interactive behavior.

### Test 1: AC4 - Health endpoint in browser

**What to test**: Health check endpoint returns JSON with status, timestamp, and version

**Steps**:

1. Start the dev server: `npm run dev` (from `packages/poem-app/`)
2. Open browser to `http://localhost:4321/api/health`
3. Observe the JSON response displayed

**Expected Result**:
‚úÖ Browser shows JSON response with:

- `"status": "ok"`
- `"timestamp"` with ISO 8601 format (e.g., `"2025-12-23T08:30:27.578Z"`)
- `"version": "0.1.0"`

**Evidence**:

- Screenshot showing JSON in browser
- Response should be formatted/raw JSON (not HTML)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 2: AC5 - Server starts with custom PORT

**What to test**: Server respects PORT environment variable

**Steps**:

1. Stop any running server (Ctrl+C)
2. Run: `PORT=5555 npm run dev`
3. Observe terminal output for port number
4. Open browser to `http://localhost:5555/api/health`

**Expected Result**:
‚úÖ Terminal shows:

- `Local    http://localhost:5555/`
- Server starts without errors

‚úÖ Browser:

- Health endpoint responds at port 5555

**Evidence**:

- Terminal screenshot showing port 5555
- Browser screenshot showing response

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 3: AC1 - Astro server startup

**What to test**: Astro server starts quickly without errors

**Steps**:

1. Run: `npm run dev` (from `packages/poem-app/`)
2. Observe terminal output

**Expected Result**:
‚úÖ Terminal shows:

- `astro  v5.x.x ready in XXX ms` (should be < 3 seconds)
- No error messages (warnings about adapter are OK)
- `Local    http://localhost:4321/`

**Evidence**:

- Terminal screenshot showing startup message

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

## ü§ñ Terminal Tests (Scriptable)

Tests using command-line tools - copy-paste ready commands.

### Test A: AC1 - Astro dependency version

**What to test**: Astro 5.x is installed

**Command**:

```bash
cd packages/poem-app && grep '"astro"' package.json
```

**Expected Output**:

```
    "astro": "^5.0.0",
```

**Validation**:

- ‚úÖ Astro version starts with ^5
- ‚úÖ Listed in dependencies section

**Status**: ‚úÖ Passed

**Notes**: Output: `"astro": "^5.0.0",` - Astro 5.x confirmed

---

### Test B: AC2 - TypeScript configuration

**What to test**: TypeScript is configured with tsconfig.json

**Command**:

```bash
cd packages/poem-app && cat tsconfig.json | head -5
```

**Expected Output**:

```json
{
  "extends": "astro/tsconfigs/strict",
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
```

**Validation**:

- ‚úÖ File exists
- ‚úÖ Extends Astro strict config
- ‚úÖ Modern ES2022 target

**Status**: ‚úÖ Passed

**Notes**: tsconfig.json extends astro/tsconfigs/strict with ES2022 target

---

### Test C: AC3 - Directory structure

**What to test**: Required directories exist

**Command**:

```bash
cd packages/poem-app && ls -d src/pages/api src/services src/config tests 2>/dev/null && echo "All directories exist"
```

**Expected Output**:

```
src/pages/api
src/services
src/config
tests
All directories exist
```

**Validation**:

- ‚úÖ `src/pages/api/` exists
- ‚úÖ `src/services/` exists
- ‚úÖ `src/config/` exists
- ‚úÖ `tests/` exists

**Status**: ‚úÖ Passed

**Notes**: All 4 directories confirmed to exist

---

### Test D: AC4 - Health endpoint via curl

**What to test**: Health endpoint returns correct JSON

**Prerequisite**: Server must be running (`npm run dev`)

**Command**:

```bash
curl -s http://localhost:4321/api/health | jq .
```

**Expected Output**:

```json
{
  "status": "ok",
  "timestamp": "2025-12-23T...",
  "version": "0.1.0"
}
```

**Validation**:

- ‚úÖ Response is valid JSON
- ‚úÖ Contains `status: "ok"`
- ‚úÖ Contains `timestamp` (ISO format)
- ‚úÖ Contains `version: "0.1.0"`

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test E: AC6 - Package.json scripts

**What to test**: Required npm scripts exist

**Command**:

```bash
cd packages/poem-app && grep -E '"(dev|build|preview)"' package.json
```

**Expected Output**:

```
    "dev": "astro dev",
    "build": "astro build",
    "preview": "astro preview",
```

**Validation**:

- ‚úÖ `dev` script exists
- ‚úÖ `build` script exists
- ‚úÖ `preview` script exists

**Status**: ‚úÖ Passed

**Notes**: All 3 scripts present: dev, build, preview

---

### Test F: AC7 - Tailwind CSS configuration

**What to test**: Tailwind CSS is configured

**Command**:

```bash
cd packages/poem-app && ls tailwind.config.mjs && grep "tailwind" astro.config.mjs
```

**Expected Output**:

```
tailwind.config.mjs
import tailwind from "@astrojs/tailwind";
  integrations: [tailwind()],
```

**Validation**:

- ‚úÖ `tailwind.config.mjs` exists
- ‚úÖ Tailwind imported in astro.config.mjs
- ‚úÖ Tailwind in integrations array

**Status**: ‚úÖ Passed

**Notes**: Tailwind config file exists and integration configured in astro.config.mjs

---

### Test G: AC3 - Config service file

**What to test**: Config service exports configuration

**Command**:

```bash
cd packages/poem-app && cat src/config/index.ts
```

**Expected Output**:

```typescript
/**
 * POEM App Configuration
 * Reads from environment variables with sensible defaults
 */
export const config = {
  server: {
    port: parseInt(process.env.PORT || '4321', 10),
    host: process.env.HOST || 'localhost',
  },
  version: process.env.npm_package_version || '0.1.0',
};

export type Config = typeof config;
```

**Validation**:

- ‚úÖ Exports `config` object
- ‚úÖ Has `server.port` with default 4321
- ‚úÖ Has `server.host` with default localhost
- ‚úÖ Has `version` field
- ‚úÖ Exports `Config` type

**Status**: ‚úÖ Passed

**Notes**: Config service file matches expected implementation exactly

---

## ‚è≥ Not Testable Yet

None - all acceptance criteria are testable in this story.

---

## Test Checklist

Copy this checklist to track overall progress:

**Human Tests:**

- [ ] Test 1: Health endpoint in browser
- [ ] Test 2: Server starts with custom PORT
- [ ] Test 3: Astro server startup

**Terminal Tests:**

- [x] Test A: Astro dependency version ‚úÖ
- [x] Test B: TypeScript configuration ‚úÖ
- [x] Test C: Directory structure ‚úÖ
- [ ] Test D: Health endpoint via curl (requires server running)
- [x] Test E: Package.json scripts ‚úÖ
- [x] Test F: Tailwind CSS configuration ‚úÖ
- [x] Test G: Config service file ‚úÖ

**Overall Status**: üîÑ In Progress (6/7 terminal tests passed, 3 human tests pending)

---

## Troubleshooting

### Issue: Port already in use

**Symptom**: `Error: listen EADDRINUSE :::4321`
**Solution**: Kill existing process or use different port: `PORT=5000 npm run dev`

### Issue: curl command not found (jq)

**Symptom**: `jq: command not found`
**Solution**: Use without jq: `curl -s http://localhost:4321/api/health`

### Issue: Server won't start

**Symptom**: Error messages on `npm run dev`
**Solution**:
1. Ensure you're in correct directory: `cd packages/poem-app`
2. Run `npm install` to ensure dependencies are installed

### Issue: Health endpoint returns 404

**Symptom**: Browser shows 404 Not Found
**Solution**: Verify file exists: `ls src/pages/api/health.ts`

---

## Test Results Summary

**Date Tested**: _________________
**Tester**: _________________

**Results**:

- Human Tests: __ / 3 passed
- Terminal Tests: __ / 7 passed
- Total: __ / 10 passed

**Issues Found**:

1. _________________
2. _________________

**Sign-off**: ‚úÖ Story accepted | ‚ùå Issues require fixes

---

_Generated by Taylor (SAT Guide Creator) from Story 1.3_
